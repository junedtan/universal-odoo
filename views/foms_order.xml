<openerp>
	<data>
		
		<!-- ORDER AREA -->
		
		<record model="ir.ui.view" id="foms_order_area_form">
			<field name="name">foms.order.area.form</field>	
			<field name="model">foms.order.area</field>
			<field name="arch" type="xml">
				<form version="7.0" string="Order Area">
					<group>
						<field name="homebase_id" />
						<field name="name" />
					</group>
				</form>
			</field>
		</record>
				
		<record model="ir.ui.view" id="foms_order_area_tree">
			<field name="name">foms.order.area.tree</field>	
			<field name="model">foms.order.area</field>
			<field name="arch" type="xml">
				<form version="7.0" string="Order Area">
					<field name="homebase_id" />
					<field name="name" />
				</form>
			</field>
		</record>
				
		<!-- ORDER AREA DELAY -->
		
		<record model="ir.ui.view" id="foms_order_area_delay_tree">
			<field name="name">foms.order.area.delay.tree</field>	
			<field name="model">foms.order.area.delay</field>
			<field name="arch" type="xml">
				<tree version="7.0" string="Order Area Delay" editable="bottom">
					<field name="area_from_id" />
					<field name="area_to_id" />
					<field name="delay" type="char" />
				</tree>
			</field>
		</record>
				
		<!-- ORDER -->
		
		<record model="ir.ui.view" id="foms_order_form">
			<field name="name">foms.order.form</field>	
			<field name="model">foms.order</field>
			<field name="context">{'source':'form'}</field>
			<field name="arch" type="xml">
				<form version="7.0" string="Customer Order" >
					<header>
						<button name="action_cancel" string="Cancel Order" type="object" states="new,confirmed,ready" groups="universal.group_universal_dispatcher" /> 
						<button name="action_confirm" string="Confirm" type="object" states="new" confirm="Are you sure to confirm this order?" groups="universal.group_universal_dispatcher" /> 
						<field name="state" widget="statusbar" readonly="1" />
					</header>
					<group>
						<group>
							<field name="id" invisible="1" />
							<field name="name" readonly="1" />
							<field name="customer_contract_id" options="{'no_create': 1, 'force_onchange': 1}" on_change="onchange_customer_contract_id(customer_contract_id)"
									attrs="{'readonly': [('state','not in',['new','rejected','confirmed','ready'])]}"/>
							<field name="service_type"
									attrs="{'readonly': [('state','not in',['new','rejected','confirmed','ready'])]}"
									on_change="onchange_service_type(customer_contract_id, fleet_type_id, service_type, start_planned_date)"/>
							<field name="order_type_by_order" attrs="{'invisible': [('service_type','!=','by_order')]}"/>
							<field name="fleet_type_id" attrs="{'invisible': [('service_type','!=','by_order')], 'required': [('service_type','=','by_order')], 'readonly': [('state','not in',['new','rejected','confirmed','ready'])]}" widget="selection" on_change="onchange_fleet_type(customer_contract_id, fleet_type_id, service_type)" />
							<field name="order_by"
									on_change="onchange_request_by(service_type, customer_contract_id, order_by, start_planned_date)"
									options="{'no_create': 1}" attrs="{'readonly': [('state','not in',['new','rejected','confirmed','ready'])]}"/>
							<field name="over_quota_status" readonly="1" />
						</group>
						<group>
							<field name="request_date" attrs="{'readonly': [('state','not in',['new','rejected','confirmed','ready'])]}"/>
							<field name="actual_vehicle_id" options="{'no_create': 1}" attrs="{'readonly': [('state','not in',['started','start_confirmed','finished','finish_confirmed'])]}" />
							<field name="actual_driver_id" options="{'no_create': 1}" attrs="{'readonly': [('state','not in',['started','start_confirmed','finished','finish_confirmed'])]}" />
							<field name="pin" attrs="{'invisible': [('service_type','!=','by_order')]}" readonly="1" />
							<field name="driver_mobile" invisible="True"/>
						</group>
					</group>
					<notebook>
						<page string="Planning">
							<group>
								<group string="Dates and Places">
									<field name="start_planned_date" attrs="{'readonly': [('state','not in',['new','rejected','confirmed','ready'])]}" />
									<field name="finish_planned_date" attrs="{'readonly': [('state','not in',['new','rejected','confirmed','ready'])]}"/>
									<field name="origin_location" attrs="{'invisible': [('service_type','!=','by_order')], 'readonly': [('state','not in',['new','rejected','confirmed','ready'])]}" />
									<field name="origin_area_id" options="{'no_create': 1}" attrs="{'invisible': [('service_type','!=','by_order')], 'required': [('service_type','=','by_order')], 'readonly': [('state','not in',['new','rejected','confirmed','ready'])]}" />
									<field name="dest_location" attrs="{'invisible': [('service_type','!=','by_order')], 'readonly': [('state','not in',['new','rejected','confirmed','ready'])]}" />
									<field name="dest_area_id" options="{'no_create': 1}" attrs="{'invisible': [('service_type','!=','by_order')], 'required': [('service_type','=','by_order')], 'readonly': [('state','not in',['new','rejected','confirmed','ready'])]}" />
									<field name="route_id" attrs="{'invisible': [('service_type','!=','shuttle')]}" />
								</group>
								<group string="Assignments">
									<field name="alloc_unit_id" options="{'no_create': 1}" attrs="{'invisible': [('service_type','!=','by_order')], 'readonly': [('state','not in',['new','rejected','confirmed','ready'])]}" />
									<field name="alloc_unit_usage" attrs="{'invisible': [('service_type','!=','by_order')], 'readonly': [('state','not in',['new','rejected','confirmed','ready'])]}" />
									<field name="assigned_vehicle_id" options="{'no_create': 1}" on_change="onchange_assigned_vehicle(customer_contract_id, assigned_vehicle_id)"
											attrs="{'readonly': ['|',('state','not in',['new','rejected','confirmed','ready']),
											'&amp;',('service_type','=','full_day'),('id','=',False)]}"/>
									<field name="assigned_driver_id" options="{'no_create': 1}"
											attrs="{'readonly': ['|',('state','not in',['new','rejected','confirmed','ready']),
											'&amp;',('service_type','=','full_day'),('id','=',False)]}"/>
								</group>
							</group>
						</page>
						<page string="Passengers">
							<group>
								<field name="passenger_count" attrs="{'readonly': [('state','not in',['new','rejected','confirmed','ready','started'])]}"/>
							</group>
							<field name="passengers" attrs="{'readonly': [('state','not in',['new','rejected','confirmed','ready','started'])]}">
								<tree version="7.0" editable="bottom">
									<field name="name" />
									<field name="phone_no" />
									<field name="is_orderer" />
								</tree>
							</field>
						</page>
						<page string="Execution">
							<group>
								<group>
									<field name="confirm_date" attrs="{'readonly': 1}"/>
									<field name="confirm_by" options="{'no_create': 1}" attrs="{'readonly': 1}"/>
								</group>
							</group>
							<group>
								<group>
									<field name="start_date" attrs="{'readonly': 1}"/>
									<field name="start_confirm_date" attrs="{'readonly': 1}"/>
									<field name="start_confirm_by" options="{'no_create': 1}" attrs="{'readonly': 1}"/>
									<field name="start_from" attrs="{'readonly': 1}"/>
								</group>
								<group>
									<field name="finish_date" attrs="{'readonly': 1}"/>
									<field name="finish_confirm_date" attrs="{'readonly': 1}"/>
									<field name="finish_confirm_by" options="{'no_create': 1}" attrs="{'readonly': 1}"/>
									<field name="finish_from" attrs="{'readonly': 1}"/>
								</group>
							</group>
							<group>
								<group>
									<field name="pause_count" attrs="{'readonly': 1}"/>
									<field name="pause_minutes" widget="float_time" attrs="{'readonly': 1}"/>
									<field name="is_lk_pp" attrs="{'readonly': 1}"/>
									<field name="is_lk_inap" attrs="{'readonly': 1}"/>
								</group>
							</group>
						</page>
						<page string="Cancellation">
							<group>
								<group>
									<field name="cancel_date" attrs="{'readonly': 1}"/>
									<field name="cancel_by" options="{'no_create': 1}" attrs="{'readonly': 1}"/>
									<field name="cancel_previous_state" attrs="{'readonly': 1}"/>
								</group>
								<group>
									<field name="cancel_reason" options="{'no_create': 1}" attrs="{'readonly': 1}"/>
									<field name="cancel_reason_other" string="Other Reason" attrs="{'readonly': 1}"/>
								</group>
							</group>
						</page>
					</notebook>
					<div class="oe_chatter">
						<field name="message_follower_ids" widget="mail_followers" groups="base.group_user"/>
						<field name="message_ids" widget="mail_thread"/>
					</div>
				</form>
			</field>
		</record>
		
		<record model="ir.ui.view" id="foms_order_tree">
			<field name="name">foms.order.tree</field>	
			<field name="model">foms.order</field>
			<field name="arch" type="xml">
				<tree version="7.0" string="Customer Orders">
					<field name="name" />
					<field name="customer_name" />
					<field name="order_by" />
					<field name="assigned_vehicle_id" invisible="context.get('hide_assigned', False)" />
					<field name="assigned_driver_id" invisible="context.get('hide_assigned', False)" />
					<field name="actual_vehicle_id" invisible="context.get('hide_actual', False)" />
					<field name="actual_driver_id" invisible="context.get('hide_actual', False)" />
					<field name="start_planned_date" invisible="context.get('hide_planned_time', False)" />
					<field name="finish_planned_date" invisible="context.get('hide_planned_time', False)" />
					<field name="start_date" invisible="context.get('hide_actual_time', False)" />
					<field name="finish_date" invisible="context.get('hide_actual_time', False)" />
					<field name="cancel_reason" invisible="context.get('hide_cancel', False)" />
					<field name="cancel_reason_other" invisible="context.get('hide_cancel', False)" />
					<field name="cancel_by" invisible="context.get('hide_cancel', False)" />
					<field name="state" invisible="not context.get('all', False)" />
				</tree>
			</field>
		</record>		

		<!-- ORDER CANCELLATION -->
		
		<record model="ir.ui.view" id="foms_order_cancel_memory_form">
			<field name="name">foms.order.cancel.memory.form</field>	
			<field name="model">foms.order.cancel.memory</field>
			<field name="arch" type="xml">
				<form version="7.0" string="Order Cancellation Form">
					<group>
						<field name="order_id" readonly="1" />
						<field name="start_planned_date" readonly="1" />
						<field name="finish_planned_date" readonly="1" />
						<field name="cancel_reason" widget="selection" />
						<field name="cancel_reason_other" />
					</group>
					<footer>
						<button string="Submit Cancellation" name="action_execute_cancel" type="object" class="oe_highlight" />
						or
						<button string="Cancel" special="cancel" />
					</footer>
				</form>
			</field>
		</record>

		<!--Replace Vehicle-->

		<record model="ir.ui.view" id="foms_order_replace_vehicle_tree">
			<field name="name">foms.order.replace.vehicle.tree</field>
			<field name="model">foms.order.replace.vehicle</field>
			<field name="arch" type="xml">
				<tree version="7.0" string="Order Replace Vehicle" edit="false" delete="false">
					<field name="replacement_date" />
					<field name="replaced_vehicle_id" />
					<field name="replacement_vehicle_id" />
				</tree>
			</field>
		</record>

		<record model="ir.ui.view" id="foms_order_replace_vehicle_form">
			<field name="name">foms.order.replace.vehicle.form</field>
			<field name="model">foms.order.replace.vehicle</field>
			<field name="arch" type="xml">
				<form version="7.0" string="Order Replace Vehicle" edit="false" delete="false">
					<group>
						<field name="replaced_vehicle_id" options="{'no_create': 1}" />
						<field name="replacement_vehicle_id" options="{'no_create': 1}" />
						<field name="replacement_date"/>
					</group>
					<notebook>
						<page string="Reason">
							<field name="replacement_reason" nolabel="1"/>
						</page>
					</notebook>
				</form>
			</field>
		</record>
		
		<!--Replace Driver-->

		<record model="ir.ui.view" id="foms_order_replace_driver_tree">
			<field name="name">foms.order.replace.driver.tree</field>
			<field name="model">foms.order.replace.driver</field>
			<field name="arch" type="xml">
				<tree version="7.0" string="Order Replace Driver" edit="false" delete="false">
					<field name="replacement_date" />
					<field name="replaced_driver_id" />
					<field name="replacement_driver_id" />
				</tree>
			</field>
		</record>

		<record model="ir.ui.view" id="foms_order_replace_driver_form">
			<field name="name">foms.order.replace.driver.form</field>
			<field name="model">foms.order.replace.driver</field>
			<field name="arch" type="xml">
				<form version="7.0" string="Order Replace Driver" edit="false" delete="false">
					<group>
						<field name="replaced_driver_id" options="{'no_create': 1}" domain="[('job_id', '=', %(hr_job_driver)d)]"/>
						<field name="replacement_driver_id" options="{'no_create': 1}" domain="[('job_id', '=', %(hr_job_driver)d)]"/>
						<field name="replacement_date" />
					</group>
					<notebook>
						<page string="Reason">
							<field name="replacement_reason" nolabel="1"/>
						</page>
					</notebook>
				</form>
			</field>
		</record>
				
	</data>
</openerp>